

<!DOCTYPE html>
<html >

<head>
  <meta charset="UTF-8">
  
  <title>Twitch TV</title>
  
  
  
  <link rel='stylesheet prefetch' href='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.0.0-alpha.6/css/bootstrap.min.css'>
<link rel='stylesheet prefetch' href='https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.min.css'>
<link rel='stylesheet prefetch' href='https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.css'>

      <style>
      .footer {
  display: block;
  text-align: center;
  color: grey;
  font-size: 15px;
  margin-top: 30px;
  padding-top: 30px;
  margin-bottom: 20px;
  border-top: 1px solid grey;
}

.frame {
  padding: 6% 10px;
  background-color: #6441A5;
  margin: 5px;
  border: 8px solid #453862;
  box-shadow: 20px 20px 10px;
  margin: auto;
  width: 80%;
  margin-bottom: 10%;
  margin-top: 10%;
  max-width: 1000px;
  min-width: 430px;
}

.main-logo-container {
  text-align: center;
  margin: auto;
}

.ch {
  font-size: 1.3em;
  color: #ff7ef4;
  font-weight: bold;
}

.st-txt {
  font-weight: bold;
  width: 150px;
  margin: auto;
  text-align: center;
  margin-bottom: 0px;
  color: #453862;
  border-top: 2px solid #453862;
  position: relative;
  top: 10px;
}

.main-logo {
  width: 60%;
  max-width: 800px;
  min-width: 220px;
}

.main-logo:hover {
  cursor: pointer;
  transform: scale(1.05);
}

.search-container {
  margin-top: 20px;
  margin-bottom: 20px;
  text-align: center;
}

#search {
  border: 5px solid #453862;
  font-weight: bold;
  margin: auto;
  width: 40%;
  max-width: 800px;
  min-width: 220px;
  padding: 12px 18px 12px 40px;
  color: #6441a5;
}

sr {
  border: 1px solid #999;
  padding: 3px 18px 3px 4px;
  border-radius: 3px;
  transition: background 0.4s;
}

.clearable {
  background: #fff url(https://www.dropbox.com/s/zzbg4x1zw0jroh3/clear.gif?dl=1) no-repeat right -10px center;
  border: 1px solid #999;
  padding: 3px 18px 3px 4px;
  border-radius: 3px;
  transition: background 0.4s;
}

.clearable.x {
  background: #fff url(https://www.dropbox.com/s/zzbg4x1zw0jroh3/clear.gif?dl=1) no-repeat right 10px center;
}

.clearable.onX {
  cursor: pointer;
}

.clearable::-ms-clear {
  display: none;
  width: 0;
  height: 0;
}

.searchable {
  background: #fff url(https://www.dropbox.com/s/8a7c3olbqsu6tmw/search.png?dl=1) no-repeat left -8px center;
  border: 1px solid #999;
  padding: 3px 18px 3px 4px;
  border-radius: 3px;
  transition: background 0.4s;
}

ul {
  margin-top: 20px;
  margin: auto;
  max-width: 800px;
  min-width: 300px;
}

li {
  padding-left: 10px;
  list-style-type: none;
  width: 90%;
  max-width: 1000px;
  margin-bottom: 25px;
}

li:hover {
  position: relative;
  top: -10px;
  left: -10px;
  transform: scale(1.08);
}

.li-img {
  border-right: 1px solid black;
  padding: 2%;
  display: inline-block;
  width: 20%;
}

.li-img {
  margin-right: 20px;
  box-shadow: 5px 5px 5px;
}

.info {
  padding: 25px;
  box-shadow: 8px 8px 8px;
  background-color: rgba(46, 48, 47, 0.56);
  vertical-align: middle;
  margin-left: 2%;
  display: inline-block;
  width: 70%;
  text-align: center;
}

.online {
  border-left: 10px solid #0F0;
}

.switch {
  border: 2px solid black;
  margin: auto;
  margin-bottom: 20px;
  display: block;
  height: 20px;
  width: 20px;
  background-color: green;
  border-radius: 50%;
}

.filtered {
  display: none;
}

.switch:hover {
  cursor: pointer;
}

a:link, a:visited {
  color: black;
}

a:hover {
  text-decoration: none;
  color: black;
}

.game {
  color: #f5df3a;
  font-size: 1.2em;
  font-weight: bold;
}

.status {
  color: #58ffff;
  font-size: 0.9em;
}

.st {
  color: #9ead99;
}

.st_online {
  color: #58f827;
  font-weight: bold;
}

.off-info {
  color: #00ffb7;
  border: 3px solid red;
}

    </style>

  
  
  
  
</head>

<body translate="no" >

  <div class="container-fluid">
  
  <div class="frame">
    <div class="main-logo-container">
      <img class="main-logo img img-responsive" src="https://www.dropbox.com/s/v3v9b41q768cfhm/twitch_logo_purple.jpg?dl=1" alt="Twitch logo"/>
    </div>
    <div class="search-container">
      
      <div class="ui-widget">
        <input id="search" class="" type="search" name="search" placeholder="Search channel..">
        </div>
    
    </div>
    <div class="st-txt"><p>Filter online</p>
</div>
    <div class="switch"></div>
    <div class="list-container">
      <ul>
        <!--<li class=""><img src="https://static-cdn.jtvnw.net/jtv_user_pictures/freecodecamp-profile_image-d9514f2df0962329-300x300.png" class="li-img img img-responsive" /><div class="info">Infomation</div></li> -->
      </ul>
    </div>
  </div>
  <div class="footer"><p>Created by Supun Manathunga</div>
  
</div>
  
  <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js'></script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js'></script>

    <script>
    $(document).ready(function() {

  $.ajaxSetup({
    // Disable caching of AJAX responses
    cache: false
});

  /*var pro_pics = ["https://static-cdn.jtvnw.net/jtv_user_pictures/esl_sc2-profile_image-d6db9488cec97125-300x300.jpeg", "https://static-cdn.jtvnw.net/jtv_user_pictures/ogamingsc2-profile_image-9021dccf9399929e-300x300.jpeg", "https://static-cdn.jtvnw.net/jtv_user_pictures/cretetion-profile_image-12bae34d9765f222-300x300.jpeg", "https://static-cdn.jtvnw.net/jtv_user_pictures/freecodecamp-profile_image-d9514f2df0962329-300x300.png", "https://static-cdn.jtvnw.net/jtv_user_pictures/xarth/404_user_70x70.png", "https://static-cdn.jtvnw.net/jtv_user_pictures/habathcx-profile_image-d75385dbe4f42a66-300x300.jpeg", "https://static-cdn.jtvnw.net/jtv_user_pictures/robotcaleb-profile_image-9422645f2f0f093c-300x300.png",  "https://static-cdn.jtvnw.net/jtv_user_pictures/noobs2ninjas-profile_image-34707f847a73d934-300x300.png" ]*/

  var base = "https://wind-bow.gomix.me/twitch-api/channels/";
  var base_status = "https://wind-bow.gomix.me/twitch-api/streams/";
  var users = ["ESL_SC2", "OgamingSC2", "streamerhouse", "admiralbulldog", "cretetion", "freecodecamp", "habathcx", "cutomer404", "RobotCaleb", "noobs2ninjas"];
  
  load();
  getStatus();
  
  $(".switch").on("click",function(){
    //console.log("clicked");
    toggle();
    //filterOnline();
  });
  
  $(".main-logo").on("click",function(){
    $("ul").html("");
    load();
    getStatus();
  });
  $("#search").on("keyup",search);
  
  function search(){
    var input = $("#search").val().toLowerCase();
    users.forEach(function(item){
      var cs = "." + item.toLowerCase();
      if(item.toLowerCase().indexOf(input)<0){
        $(cs).addClass("filtered");
      }
      else{
        $(cs).removeClass("filtered");
      }
    });
  }
  
  function toggle(){
    if($(".switch").hasClass("on")){
      showAll();
    }
    else {
      filterOnline();
    }
  }
  
  function showAll(){
    $(".switch").css("background-color","green");
    $(".switch").removeClass("on");
    for(var i = 0; i < users.length; i++){
      $("li").eq(i).css("display","");
    }
  }
  
  function filterOnline(){
    $(".switch").addClass("on");
    $(".switch").css("background-color", "#0F0");
    for(var i = 0; i < users.length; i++){
      if(!$("li").eq(i).hasClass("online")){
        $("li").eq(i).css("display","none");
        console.log($("li").eq(i).attr("class"));
      }
    }
  }
  
function load(){
    for (var i = 0; i < users.length; i++) {
    var query = base + users[i] + "?callback=?";
    $.getJSON(query, function(data) {
      //console.log(data);
      if(data.status == 404){
        
        show404(data.message);
      }
      else{
      var logo = data.logo;
      var des = (data._links.self).split("/")[((data._links.self).split("/")).length-1];
      var info =  "<span class=\"ch\">" + des + "<span><br>"   +"<span class=\"game\">" + data.game +"</span><br><span class=\"status\">" + data.status +"</span><br><span class=\"st\">offline</span>";
      
      makeLi(logo, des,info,data.url);
      }
    });
      
  }
  
}
  
 

  function getStatus(){
    for (var i = 0; i < users.length; i++) {
    var query = base_status + users[i] + "?callback=?";
    //console.log(st_array);
    $.getJSON(query, function(data) {
      //var logo = data.logo;
      //var des = data.status;
      //makeLi(logo, des);
      var channel_ar = data._links.channel.split("/");
      var ch = channel_ar[channel_ar.length-1];
      //console.log(data);
      if(data.stream != null){
        makeOnline(ch);
      }
      //else if(data.stream)
    });
  }
  }
  
  

function makeOnline(x){
  
  setTimeout(function(){
    var c = "." + x.toLowerCase();
  //console.log(c);
  $(c).addClass("online");
  //console.log($(c).html());
  $(c).find(".st").html("online");
  $(c).find(".st").addClass("st_online");
 // console.log($(c).find(".st").html());
  //console.log($(c).attr("class"));
  }, 1000);
  
  
}
  
  
  function makeLi(logo, des, info,url){
    
    var img =  "<li class=" + des + ">" + "<a href=\"" + url + "\"target=\"_blank\">" + "<img src=" + logo + " class=\"li-img img img-responsive img-thumbnail\" />" ;
    var info = "<div class=\"info\">" + info + "</div></a></li>";
    $("ul").append(img+info);
    
  }
  
   function show404(msg){
    console.log(msg);
     var logo_off = "https://www.dropbox.com/s/7lyspzflcui0fxy/nomore404_l.png?dl=1";
     var img =  "<li class=" + ">" + "<a href=\"" + "\">" + "<img src=\"" + logo_off + "\" class=\"li-img img img-responsive img-thumbnail\" />" ;
    var info = "<div class=\"off-info info\">" + msg + "</div></a></li>";
    $("ul").append(img+info);
     
  }
  
  function tog(v) {
    return v ? "addClass" : "removeClass";
  }
  
  
  $(document)
    .on("input", ".sr", function() {
      $(this)[tog(this.value)]("x");
    })
    .on("mousemove", ".x", function(e) {
      $(this)[
        tog(
          this.offsetWidth - 18 < e.clientX - this.getBoundingClientRect().left
        )
      ]("onX");
    })
    .on("touchstart click", ".onX", function(ev) {
      ev.preventDefault();
      $(this).removeClass("x onX").val("").change();
    search();
    });
});
  </script>

  
  

</body>
</html>
 
